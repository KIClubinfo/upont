<div ng-controller="Publications_List_Messages_Ctrl" ng-inject="{messages: messages}">
    <div infinite-scroll="next()" infinite-scroll-distance="2" infinite-scroll-disabled="$root.infiniteLoading">
        <div class="up-ticket" ng-repeat="message in messages.data">
            <div up-row class="up-messages" ng-mouseover="showModify=true" ng-mouseleave="showModify=false">
                <img up-col="20%" class="up-profile-picture" ng-src="{{ message.author_user.image_url | thumb | urlFile }}"/>
                <div up-col="80%">
                    <small>
                        <span class="up-clickable" ui-sref="root.users.publications.message({slug: message.slug})" title="Afficher la publication">{{ message.date | fromNow }}</span>
                        <i ng-show="($root.isAdmin || message.author_user.username == $root.me.username) && showModify"
                           class="fa fa-pencil up-clickable" ng-click="modify(message)"
                           title="Modifier le message"></i>
                        <i ng-show="($root.isAdmin || message.author_user.username == $root.me.username) && showModify"
                           class="fa fa-trash up-clickable up-delete-button"  ng-click="delete(message)"
                           title="Supprimer le message"></i>
                    </small><br>
                    <strong up-user user="message.author_user">{{ message.author_user.nick }} :</strong><br>
                    <span up-publi-text string="message.text" style="margin-top: 0"></span>
                </div>
            </div>
            <img class="img-responsive up-clickable" ng-if="message.image_url"
                 ng-click="$root.zoomIn('/api/' + message.image_url)"
                 ng-src="{{ message.image_url | thumb | urlFile }}"/>
            <div up-likes objet="message" url="'newsitems/'+message.slug"></div>
        </div>
    </div>
</div>
